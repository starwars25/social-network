<% provide(:title, "Profile") %>
<div class="row">
  <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12"><h1>Name: <%= @current_user.username %></h1>
    <%= link_to 'Edit profile', edit_user_path(current_user) %>
    <h2>Email: <%= @current_user.email %></h2>
    <%= image_tag current_user.avatar.url, class: 'img-responsive img-thumbnail' if current_user.avatar? %>
    <% if @current_user.friend_requests.any? %>
        <h1>Friend requests</h1>
        <%= render @current_user.friend_requests %>
    <% end %></div>
</div>
<% if @current_user.friends.any? %>
    <div class="row">
      <div class="col-xs-3 col-sm-3 col-md-3 col-lg-3"><h1>Friends</h1>
        <% @user.friends.each do |friend| %>
            <ul class="list-unstyled">
              <li><%= link_to friend.username, friend %></li>
              <li><%= friend.email %></li>
              <li><%= image_tag friend.avatar.url, class: 'img-responsive img-thumbnail' if friend.avatar? %></li>
            </ul>

        <% end %></div>
<% end %>
<div class="col-xs-9 col-sm-9 col-md-9 col-lg-9"><h1>The wall</h1>

  <div id="wall"><%= render @feed %></div>
  <%= will_paginate @feed %>
  <%= render 'shared/post_form' %></div></div>
<%= subscribe_to "/wall/#{@user.id}" %>
<script>
    PrivatePub.subscribe('/wall/<%= @user.id %>', function (data, channel) {
        $('#wall').prepend(formInput(data));
    });
    form_input = function (data) {
        var output;
        return output = "<div class=\"post\"><p><strong>" + data.post.from + "</strong></p><p>" + data.post.content + "</p><img src=\"" + data.post.image + "\" class=\"img-responsive img-thumbnail post_image\" /><hr></div>";
    };
    $('#post_content').keypress(function (e) {
        if (e.which === 13) {
            return $('#new_post').submit();
        }
    });
</script>